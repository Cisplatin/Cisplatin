{% extends "blogs/blog.html" %}
{% load staticfiles %}

{% block title %}
Exploits using .xlsx files
{% endblock %}

{% block body %}
<p><i>
Disclaimer: The information provided here is purely for educational purposes. The creator of this article assumes no responsibility for misuse of the information provided.
</i></p>
<p>
Many web applications, specifically SaaS applications, offer some sort of Excel export feature. Exploitation of these features is a relatively small niche, and as a result there generally exists many vulnerabilities in these features. This post will outline some approaches to exploiting a web application's Excel features.
</p>
<h3>CSV Injection</h3>
<p>
Some websites offer a feature to export site data to an excel spreadsheet. Usually, this exported data is data that the user has inputted. Let's say that there exists an export feature in an Excel that includes some user input. With this, an excel export might look something like this:
</p>
<br><center><img src="{% static "img/xlsx_exploits_1.png" %}"></center><br>
<p>
If the website in question fails to escape user input (which it usually does), you can try changing your name to something like <code>=1+1</code>, and if you're lucky you'll get an output that looks like:
</p>
<br><center><img src="{% static "img/xlsx_exploits_2.png" %}"></center></br>
<p>
You might say "but Simon, who cares if we can calculate 1 + 1? Even my little sister can do that!". Well, here's the catch: Excel offers many commands that can be used much more maliciously. For example, if we change our name to <code>=-2+3+cmd|' /C calc'!A0</code>, Windows' version of Excel will open the calculator application. This can be used to execute many other applications, and even execute commands inside of these applications. Moreover, these commands can be used to send information from the user's computer to an arbitrary server via a GET request. Needless to say, this can be used for malicious purposes and so should be protected against.
</p>
<p>
The best way to protect against these injections is to escape any Excel "trigger" characters in cells that the user input is sent to. These are characters that will result in the cell being parsed as a formula. The only characters you need to worry about are <code>%</code>, <code>=</code>, <code>+</code> and <code>-</code>. You can escape these by prepending a <code>'</code> to the cell, so that the cell is parsed as a string and not as a formula.
</p>
{% endblock %}
